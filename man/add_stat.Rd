% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/add_stat.R
\name{add_stat}
\alias{add_stat}
\title{Add a statistic column}
\usage{
add_stat(
  x,
  fns,
  fmt_fun = style_sigfig,
  header = "**Statistic**",
  footnote = NULL,
  new_col_name = NULL
)
}
\arguments{
\item{x}{tbl_summary object}

\item{fns}{list of formulas indicating the functions that create the statistic}

\item{fmt_fun}{for numeric statistics, \verb{fmt_fun=} is the styling/formatting
function. Default is \code{style_sigfig()}.}

\item{header}{Column header of new column. Default is \code{"**Statistic**"}}

\item{footnote}{Footnote associated with new column. Default is no
footnote (i.e. NULL)}

\item{new_col_name}{name of new column to be created in \code{.$table_body}.
Default is \code{"add_stat_1"}, unless that column exists then it is \code{"add_stat_2"}, etc.}
}
\description{
The function allows a user to add a new column with any new statistic.
}
\section{Example Output}{

\if{html}{Example 1}

\if{html}{\figure{add_stat_ex1.png}{options: width=60\%}}

\if{html}{Example 2}

\if{html}{\figure{add_stat_ex2.png}{options: width=60\%}}
}

\examples{
# Example 1 ----------------------------------
# fn returns t-test pvalue
my_ttest <- function(data, variable, by, ...) {
  t.test(data[[variable]] ~ as.factor(data[[by]]))$p.value
}

add_stat_ex1 <-
  trial[c("trt", "age", "marker")] \%>\%
  tbl_summary(by = trt, missing = "no") \%>\%
  add_p(test = everything() ~ t.test) \%>\% # using add_p() to calculate
  # replicating result with add_stat()
  add_stat(fns = everything() ~ my_ttest, # all variables compared with with t-test
           fmt_fun = style_pvalue, # result formatted with style_pvalue()
           header = "**My p-value**") # new column header

# Example 2 ----------------------------------
# fn returns t-test test statistic and pvalue
my_ttest2 <- function(data, variable, by, ...) {
  tt <- t.test(data[[variable]] ~ as.factor(data[[by]]))

  # returning test statistic and pvalue
  stringr::str_glue(
    "t={style_sigfig(tt$statistic)}, {style_pvalue(tt$p.value, prepend_p = TRUE)}"
  )
}

add_stat_ex2 <-
  trial[c("trt", "age", "marker")] \%>\%
  tbl_summary(by = trt, missing = "no") \%>\%
  add_stat(fns = everything() ~ my_ttest2, # all variables will be compared by t-test
           fmt_fun = NULL, # fn returns and chr, so no formatting function needed
           header = "**Treatment Comparison**", # column header
           footnote = "T-test statistic and p-value") # footnote
# Example 1 ----------------------------------
}
